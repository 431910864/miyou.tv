<!DOCTYPE html>
<!--
Copyright 2016 Brazil Ltd.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta charset="UTF-8">
<div class="programs view-content" ng-init="$ctrl.baseWidth = 200; $ctrl.baseHeight = 240;">
    <div class="view-content-header row trim bg-inverse">
        <div class="col-lg-2 col-sm-3 col-xs-12">
            <form class="form-horizontal" ng-if="$ctrl.archiveEnabled">
                <div class="input-group input-group-dark input-sm" title="表示データ">
                    <label class="input-group-addon control-label" for="source"><span class="fa fa-database"></span></label>
                    <select id="source" class="form-control" name="source" ng-model="$ctrl.source" ng-change="$ctrl.scrollTo(0)">
                        <option value="archive">番組表</option>
                        <option value="recorded">録画情報</option>
                    </select>
                </div>
            </form>
        </div>
        <div class="col-lg-8 col-sm-6 col-xs-12">
            <ul class="nav nav-mtvblack nav-mtvblack-line flex flex-row flex-center" ng-class="{'hidden-lg': $ctrl.dates.length > 8, 'hidden-md': $ctrl.dates.length > 5, 'hidden-sm': $ctrl.dates.length > 3, 'hidden-xs': $ctrl.dates.length > 2 }">
                <li class="flex-item trim" ng-repeat="date in $ctrl.dates" ng-class="{active: date.isCurrent}">
                    <a href="" ng-bind="date.time | date:'M/d EEE'" ng-click="$ctrl.scrollToDate(date.time)"></a>
                </li>
            </ul>
            <div ng-class="{'hidden-lg': $ctrl.dates.length <= 8, 'hidden-md': $ctrl.dates.length <= 5, 'hidden-sm': $ctrl.dates.length <= 3, 'hidden-xs': $ctrl.dates.length <= 2 }">
                <div class="input-group input-group-dark input-sm">
                    <input class="form-control text-center" type="text" uib-datepicker-popup="y/M/d EEE" datepicker-options="$ctrl.datepickerOptions" show-button-bar="false" popup-placement="bottom-right" is-open="$ctrl.datepickerOpened" ng-model="$ctrl.currentDate" ng-change="$ctrl.scrollToDate($ctrl.currentDate)">
                    <div class="input-group-btn" title="日付を選択">
                        <button class="btn btn-dark" type="button" ng-click="$ctrl.datepickerOpened = !$ctrl.datepickerOpened">
                            <span class="fa fa-calendar"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-2 col-sm-3 col-xs-12">
            <uib-dropdown class="dropdown dropdown-inverse dropdown-category" auto-close="outsideClick">
                <uib-dropdown-toggle class="btn btn-dark">
                    番組カテゴリ
                    <span class="pull-right">
                            <span class="caret"></span>
                    </span>
                </uib-dropdown-toggle>
                <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>
                    <li ng-repeat="category in $ctrl.categories">
                        <div class="checkbox text-nowrap" title="{{category.localeName}}">
                            <label>
                            <input type="checkbox" name="category" ng-model="category.checked" ng-change="$ctrl.update()">{{category.localeName}}
                        </label>
                        </div>
                    </li>
                </ul>
            </uib-dropdown>
        </div>
    </div>
    <div class="view-content-body scrollable">
        <div class="program-header program-header-horizontal" ng-style="$ctrl.hHeaderStyle">
            <div class="program-header-cell bg-primary" ng-repeat="channel in $ctrl.programs">
                <div class="program-header-content clickable" title="チャンネルで検索" ng-bind="channel.name" ng-click="$ctrl.search('sid:' + channel.sid)"></div>
            </div>
        </div>
        <div class="program-header program-header-vertical" ng-style="$ctrl.vHeaderStyle">
            <div class="program-header-cell" ng-repeat="hour in $ctrl.hours" ng-style="{height: $ctrl.baseHeight + 'px', lineHeight: $ctrl.baseHeight + 'px'}">
                <div class="program-header-content" ng-bind="hour.hour"></div>
            </div>
        </div>
        <div class="program-table">
            <div class="program-table-column" ng-repeat="column in $ctrl.programs" ng-style="column.style" ng-dblclick="$ctrl.playColumn(column, $event)">
                <div class="program-table-cell" ng-repeat="item in column.programs" ng-if="column.enabled && item.enabled" ng-style="item.style">
                    <div class="program-table-content selectable" ng-class="{selected: $ctrl.selectItem() === item}" ng-click="$ctrl.selectItem(item)" ng-dblclick="$ctrl.play(item)">
                        <span class="badge" title="{{item.countDetail}}" ng-bind="item.count"></span>
                        <span class="time text-primary" ng-bind="item.displayTime"></span>
                        <span class="title text-primary quick-search quick-search-hidden">
                            <span ng-bind="item.title"></span> <span class="fa fa-search quick-search-btn" title="番組名で検索" ng-click="$ctrl.search(item.title)"></span>
                        </span>
                        <span class="label quick-search" ng-class="'label-' + item.categoryName.name">
                            <span ng-bind="item.categoryName.localeName"></span> <span class="fa fa-search quick-search-btn" title="カテゴリで検索" ng-click="$ctrl.search('cat:' + item.categoryName.name)"></span>
                        </span>
                        <div class="detail" ng-bind="item.detail"></div>
                        <div class="preview text-center" ng-if="item.preview" ng-click="$ctrl.play(item)">
                            <img width="160" height="90" ng-src="{{item.preview}}">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <form class="form-play">
        <button class="btn btn-play" type="button" title="選択した番組を再生" ng-click="$ctrl.play($ctrl.selectItem())">再生</button>
    </form>
</div>
