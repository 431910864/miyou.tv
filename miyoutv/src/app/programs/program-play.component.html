<!DOCTYPE html>
<!--
Copyright 2016-2018 Brazil Ltd.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta charset="UTF-8">
<div class="player view-content">
    <div class="view-content-header row m-0 bg-dark text-light text-nowrap">
        <div class="col-4 col-sm-2 p-0 text-left">
            <button class="btn btn-media" title="再生を終了" (click)="stop()">
                <img class="img-icon-md" src="assets/back.svg">
            </button>
        </div>
        <div class="col-4 col-sm-8 p-0 text-center">
            <span class="channel">{{info?.channelName}}</span>
            <span class="title">{{info?.fullTitle}}</span>
        </div>
    </div>
    <div class="view-content-body">
        <div class="row h-100 m-0">
            <div class="col-12 d-sm-flex flex-column flex h-100 p-0" [class.col-lg-8]="!sidebarCollapsed" [class.col-md-7]="!sidebarCollapsed" [class.col-sm-6]="!sidebarCollapsed" [class.d-none]="!sidebarCollapsed" [contextMenu]="playerMenu">
                <div class="screen flex-fill" (mousewheel)="onMouseWheel($event)">
                    <video-screen class="video-screen fit" (dblclick)="toggleFullscreen()"></video-screen>
                </div>
                <div class="player-control bg-dark text-light">
                    <controlbar [commentEnabled]="commentEnabled" [fullscreenEnabled]="isFullscreen" [sidebarEnabled]="!sidebarCollapsed" (commentToggle)="toggleComment()" (fullscreenToggle)="toggleFullscreen()" (sidebarToggle)="sidebarCollapsed = !sidebarCollapsed"></controlbar>
                    <seekbar [offset]="offset" [chapters]="chapters" [chartPoints]="chartPoints" [showPrevious]="true" [showNext]="true" (previous)="previous()" (next)="next()"></seekbar>
                </div>
                <context-menu #playerMenu>
                    <ng-template contextMenuItem (execute)="player.togglePause()">
                        <span class="fa fa-fw" [class.fa-pause]="player.playing" [class.fa-play]="!player.playing"></span> {{player.playing ? '一時停止' : '再生'}}
                    </ng-template>
                    <ng-template contextMenuItem (execute)="player.jumpBackward('11s')">
                        <span class="fa fa-fw fa-step-backward"></span> 10秒戻す
                    </ng-template>
                    <ng-template contextMenuItem (execute)="player.jumpForward('29s')">
                        <span class="fa fa-fw fa-step-forward"></span> 30秒進める
                    </ng-template>
                    <ng-template contextMenuItem [subMenu]="playerSpeedMenu">
                        <span class="fa fa-fw"></span> 再生速度
                    </ng-template>
                    <context-menu #playerSpeedMenu>
                        <ng-template contextMenuItem (execute)="player.speedUp()">
                            <span class="fa fa-fw fa-forward"></span> 速くする
                        </ng-template>
                        <ng-template contextMenuItem (execute)="player.normalSpeed()">
                            <span class="fa fa-fw fa-play"></span> 通常再生
                        </ng-template>
                        <ng-template contextMenuItem (execute)="player.speedDown()">
                            <span class="fa fa-fw fa-backward"></span> 遅くする
                        </ng-template>
                    </context-menu>
                    <ng-template contextMenuItem [subMenu]="playerAudioMenu">
                        <span class="fa fa-fw"></span> オーディオ
                    </ng-template>
                    <context-menu #playerAudioMenu>
                        <ng-template contextMenuItem (execute)="player.toggleAudioTrack()">
                            <span class="fa fa-fw fa-rotate-right"></span> 音声切替
                        </ng-template>
                        <ng-template contextMenuItem (execute)="player.increaseVolume(5)">
                            <span class="fa fa-fw fa-volume-up"></span> 音量を上げる
                        </ng-template>
                        <ng-template contextMenuItem (execute)="player.decreaseVolume(5)">
                            <span class="fa fa-fw fa-volume-down"></span> 音量を下げる
                        </ng-template>
                        <ng-template contextMenuItem (execute)="player.toggleMute()">
                            <span class="fa fa-fw text-primary" [class.fa-check]="player.mute"></span> ミュート
                        </ng-template>
                    </context-menu>
                    <ng-template contextMenuItem [subMenu]="playerVideoMenu">
                        <span class="fa fa-fw"></span> ビデオ
                    </ng-template>
                    <context-menu #playerVideoMenu>
                        <ng-template contextMenuItem (execute)="toggleFullscreen()">
                            <span class="fa fa-fw text-primary" [class.fa-check]="isFullscreen"></span> 全画面表示
                        </ng-template>
                        <ng-template contextMenuItem (execute)="toggleAlwaysOnTop()">
                            <span class="fa fa-fw text-primary" [class.fa-check]="isAlwaysOnTop"></span> 常に前面に表示
                        </ng-template>
                    </context-menu>

                    <ng-template contextMenuItem [subMenu]="playerCommentMenu">
                        <span class="fa fa-fw"></span> コメント
                    </ng-template>
                    <context-menu #playerCommentMenu>
                        <ng-template contextMenuItem (execute)="toggleComment()">
                            <span class="fa fa-fw text-primary" [class.fa-check]="commentEnabled"></span> コメントを表示
                        </ng-template>
                        <ng-template contextMenuItem (execute)="commentDelay = commentDelay - 500">
                            <span class="fa fa-fw fa-chevron-left"></span> 早める
                        </ng-template>
                        <ng-template contextMenuItem (execute)="commentDelay = commentDelay + 500">
                            <span class="fa fa-fw fa-chevron-right"></span> 遅らせる
                        </ng-template>
                    </context-menu>
                    <ng-template contextMenuItem (execute)="previous()">
                        <span class="fa fa-fw fa-fast-backward"></span> 前の番組へ
                    </ng-template>
                    <ng-template contextMenuItem (execute)="next()">
                        <span class="fa fa-fw fa-fast-forward"></span> 次の番組へ
                    </ng-template>
                    <ng-template contextMenuItem (execute)="sidebarCollapsed = !sidebarCollapsed">
                        <span class="fa fa-fw text-primary" [class.fa-check]="!sidebarCollapsed"></span> サイドバーを表示
                    </ng-template>
                    <ng-template contextMenuItem (execute)="player.stop()">
                        <span class="fa fa-fw fa-stop"></span> 再生を終了
                    </ng-template>
                </context-menu>
            </div>
            <div class="sidebar col-12 col-sm-6 col-md-5 col-lg-4 h-100 p-0" [collapse]="sidebarCollapsed" (collapsed)="onSidebarCollapsed()" (expanded)="onSidebarExpanded()" [style.height]="'100%'">
                <button class="sidebar-close close" (click)="sidebarCollapsed = true"><span class="fa fa-times-circle"></span></button>
                <tabset type="tabs" class="sidebar-tabset h-100 nav-mtvblack nav-mtvblack-line">
                    <tab heading="コメント">
                    </tab>
                    <tab heading="情報">
                        <program-play-info [recordInfo]="info" [programs]="programs" [commentInfo]="commentInfo"></program-play-info>
                    </tab>
                    <tab heading="再生設定">
                    </tab>
                </tabset>
            </div>
        </div>
    </div>
</div>
